# å‰è¨€

å¯¹äºæƒ³è¦å­¦ä¹  Linux çš„åŒå­¦æ¥è¯´ï¼Œæƒ³çœŸæ­£çš„ç©è½¬ Linux å°±å¿…é¡»è¦çŸ¥é“å¦‚ä½•ç®¡ç†ç£ç›˜åˆ†åŒºï¼ˆæ¯”å¦‚åˆ›å»ºå’Œåˆ é™¤ç£ç›˜åˆ†åŒºï¼‰ï¼Œå› ä¸ºæ–‡ä»¶ç³»ç»Ÿçš„æŒ‚è½½å°±ä¸ç£ç›˜åˆ†åŒºæœ‰å…³ã€‚

åœ¨ Linux ä¸­ï¼Œä¸€åˆ‡çš†æ–‡ä»¶ï¼Œæ‰€æœ‰çš„å¤–éƒ¨å­˜å‚¨ç£ç›˜è®¾å¤‡éƒ½åœ¨ `/dev` ç›®å½•ä¸‹ã€‚æ¯”å¦‚æˆ‘ä»¬ç»å¸¸ä¼šçœ‹åˆ°ç±»ä¼¼äº `/sda`ã€`/sda1`ã€`/sda2` è¿™æ ·çš„è®¾å¤‡ï¼ˆå¦‚ä¸‹ï¼‰ï¼Œå…¶å® `sda` æ‰æ˜¯çœŸæ­£çš„è®¾å¤‡ï¼Œè€Œå¸¦æ•°å­—åç¼€ï¼ˆå¦‚ `/sda1`ã€`/sda2`ï¼‰çš„è®¾ç½®åªæ˜¯è¯¥è®¾å¤‡çš„æŸä¸ªåˆ†åŒºã€‚è®¾ç½®æˆ‘ä»¬æ˜¯æ— æ³•ç›´æ¥åªç”¨çš„ï¼Œå½“æˆ‘ä»¬éœ€è¦è¿›è¡Œæ–‡ä»¶è®¾å¤‡æŒ‚è½½çš„æ—¶å€™ï¼Œå®é™…ä¸ŠæŒ‚è½½çš„å°±æ˜¯å…·ä½“çš„åˆ†åŒºã€‚æƒ³è¦å­¦ä¹  Linux çš„æ–‡ä»¶ç³»ç»Ÿï¼Œç£ç›˜åˆ†åŒºæˆ‘ä»¬å°±å¿…é¡»è¦äº†è§£ï¼

```bash
$ ls /dev/ | grep 'sd'
sda
sda1
sda2
sdb
sdb1
sdb2
sdb3
```

# æŸ¥çœ‹ç£ç›˜åˆ†åŒº

åœ¨å½“å‰çš„ Linux æ“ä½œç³»ç»Ÿä¸­ï¼Œä¸»è¦çš„ç£ç›˜åˆ†åŒºæ ¼å¼æœ‰ GPT å’Œ MBRï¼Œå…¶ä¸­ GPT æ˜¯ç›®å‰ä¸»æµçš„åˆ†åŒºæ ¼å¼ï¼Œè€Œ MBR åˆ™æ…¢æ…¢çš„è¢« GPT å–ä»£ï¼ˆæœ‰å…³ GPT å’Œ MBR åˆ†åŒºçš„çŸ¥è¯†å¯ä»¥å‚è€ƒæ–‡ç« æœ€åçš„ [å‚è€ƒé“¾æ¥ğŸ”—](#å‚è€ƒé“¾æ¥ğŸ”—)ï¼‰ã€‚

ç®¡ç†ç£ç›˜åˆ†åŒºä¸»è¦ä½¿ç”¨ `gdisk` å’Œ `fdisk` å·¥å…·è¿™ä¸¤ä¸ªå·¥å…·åˆ†åˆ«ç”¨äºç®¡ç† GPT åˆ†åŒºå’Œ MBR åˆ†åŒºï¼Œåœ¨ä½¿ç”¨æ—¶æœ€å¥½ä¸è¦æ··ç”¨ï¼Œä»¥å…é€ æˆä¸å¯æŒ½å›çš„åæœã€‚

é‚£æŸ¥çœ‹ç£ç›˜åˆ†åŒºçš„ä¿¡æ¯åŠæ ¼å¼å‘¢ï¼Ÿè¿™å°±è¦ä»‹ç»å¦‚ä¸‹ä¸‰ä¸ªå‘½ä»¤äº†ï¼š

## lsblk åˆ—å‡ºç£ç›˜åˆ—è¡¨

`lsblk` å‘½ä»¤çš„å…¨ç§°æ˜¯ list block devicesã€‚ä¹Ÿå°±æ˜¯ç”¨äºæ˜¾ç¤ºç³»ç»Ÿä¸Šçš„ç£ç›˜åˆ†åŒºåˆ—è¡¨ä¿¡æ¯ï¼Œå¸¸ç”¨çš„å‘½ä»¤è¯­æ³•å¦‚ä¸‹ï¼š

```bash
$ lsblk [-adptJ] [-o +columns] [device...]
```

ä¸‹é¢æ˜¯ä¸»è¦å¯é€‰å‚æ•°è¯´æ˜ï¼š

```
-a åˆ—å‡ºæ‰€æœ‰ç£ç›˜è®¾å¤‡åŠåˆ†åŒº
-d ä»…åˆ—å‡ºç£ç›˜è®¾å¤‡æœ¬èº«, ä¸æ˜¾ç¤ºåˆ†åŒº
-p æ˜¾ç¤ºè®¾å¤‡çš„å®Œæ•´æ–‡ä»¶å(è·¯å¾„), è€Œä¸æ˜¯ä»…åˆ—å‡ºå…·ä½“çš„è®¾å¤‡å
-t åˆ—å‡ºç£ç›˜è®¾å¤‡çš„è¯¦ç»†æ•°æ®, å¦‚ç£ç›˜é˜µåˆ—æœºåˆ¶ã€é¢„è¯»å†™çš„æ•°æ®å¤§å°ç­‰
-J ä»¥ JSON çš„æ•°æ®æ ¼å¼æ•°æ®
```

å…³äº `-o` å‚æ•°éœ€è¦åšç‰¹åˆ«çš„è¯´æ˜ï¼Œè¯¥å‚æ•°ç”¨äºæ˜¾ç¤ºé¢å¤–çš„åˆ—ä¿¡æ¯ï¼Œæ¯”å¦‚æ˜¾ç¤ºè®¾å¤‡çš„ `LABEL` å’Œ `UUID`ï¼š

```bash
$ lsblk -o +LABEL,UUID
```

|**Note**|
|:-------|
|æ³¨æ„ `-o` çš„è¯­æ³•ï¼Œä½¿ç”¨ `+` è¿½åŠ è¦æ˜¾ç¤ºçš„åˆ—ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨ `,` åˆ†éš”ã€‚|

å¦å¤–ï¼Œå¦‚æœæƒ³è¦æŸ¥çœ‹å…·ä½“æœ‰å“ªäº›å¯ç”¨äºå±•ç¤ºçš„åˆ—ï¼Œå¯ä»¥ä½¿ç”¨ `help` æˆ– `man` å‘½ä»¤æŸ¥çœ‹ï¼Œç¤ºä¾‹ï¼š

```bash
$ lsblk --help

...
Available output columns:
        NAME  device name
       KNAME  internal kernel device name
        PATH  path to the device node
     MAJ:MIN  major:minor device number
     FSAVAIL  filesystem size available
      FSSIZE  filesystem size
      FSTYPE  filesystem type
      FSUSED  filesystem size used
      FSUSE%  filesystem use percentage
       FSVER  filesystem version
  MOUNTPOINT  where the device is mounted
       LABEL  filesystem LABEL
        UUID  filesystem UUID
      PTUUID  partition table identifier (usually UUID)
...
```

ä¸‹é¢æ¥çœ‹ä¸‹å…·ä½“çš„ç¤ºä¾‹ï¼š

### åˆ—å‡ºæ‰€æœ‰ç£ç›˜è®¾å¤‡åŠåˆ†åŒº

```bash
$ lsblk -a
NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
loop0    7:0    0  43.6M  1 loop /snap/snapd/14978
loop1    7:1    0 164.8M  1 loop /snap/gnome-3-28-1804/161
loop2    7:2    0     4K  1 loop /snap/bare/5
loop3    7:3    0  65.2M  1 loop /snap/gtk-common-themes/1519
loop4    7:4    0  55.5M  1 loop /snap/core18/2284
loop5    7:5    0     0B  0 loop
loop6    7:6    0     0B  0 loop
loop7    7:7    0     0B  0 loop
sda      8:0    0 931.5G  0 disk
|-sda1   8:1    0   100G  0 part
`-sda2   8:2    0   100G  0 part
sdb      8:16   0 223.6G  0 disk
|-sdb1   8:17   0   512M  0 part /boot/efi
|-sdb2   8:18   0 222.1G  0 part /
`-sdb3   8:19   0   976M  0 part [SWAP]
```

å…¶å®ï¼Œ`-a` å‚æ•°åœ¨å®é™…ä¸­ç”¨çš„æ¯”è¾ƒå°‘ï¼Œä¸€åŠéƒ½æ˜¯ç›´æ¥ `lsblk` å°±å¥½äº†~

æ³¨æ„çœ‹ `sda` å’Œ `sdb` è¿™ä¸¤ä¸ªç£ç›˜ï¼Œåœ¨ä»–ä»¬ä¸‹é¢éƒ½æŒ‚ç€ä¸¤ä¸ªåˆ†åŒºã€‚æ¯”å¦‚ `sda` ç£ç›˜ï¼Œä¸¤ä¸ªåˆ†åŒºçš„åå­—åˆ†åˆ«æ˜¯ `sda1` å’Œ `sda2`ï¼š

```
...
sda      8:0    0 931.5G  0 disk
|-sda1   8:1    0   100G  0 part
`-sda2   8:2    0   100G  0 part
...
```

ä¸‹é¢å°±ä»¥ `sda` ç£ç›˜è®¾å¤‡åšå…·ä½“çš„è¯´æ˜ï¼š

#### ç£ç›˜åˆ†åŒºè¯´æ˜

åœ¨æ­¤ä¹‹å‰ï¼Œè¿™é‡Œæœ‰å‡ ä¸ªå…³äºåˆ†åŒºçš„æ¦‚å¿µéœ€è¦çŸ¥é“ï¼šåˆ†åŒºå°±æ˜¯æˆåŠŸä»ç£ç›˜è®¾å¤‡ä¸­ â€œç”³è¯·æŒ‡å®šå¤§å°çš„å†…å­˜ç©ºé—´â€ï¼Œåˆ›å»ºåˆ†åŒºå°±æ˜¯å°è¯•ä»ç£ç›˜è®¾å¤‡ä¸­ â€œç”³è¯·æŒ‡å®šå¤§å°çš„ç©ºé—´â€ï¼Œåˆ é™¤åˆ†åŒºå°±æ˜¯å°†æŒ‡å®šåˆ†åŒºçš„å†…å­˜å½’è¿˜ç»™ç£ç›˜è®¾å¤‡ã€‚

`sda` æ˜¯æˆ‘çš„ä¸€å—å¸Œæ· 1T å¤§å°çš„æœºæ¢°ç¡¬ç›˜ï¼Œåœ¨å½“å‰ Linux ä¸­æ˜¾ç¤ºçš„è®¾å¤‡åæ˜¯ `sda`ï¼Œå®¹é‡æ€»å¤§å°ä¸º 931.5Gï¼ˆå±…ç„¶ä¸æ˜¯ 1Tï¼Œå¥¸å•†ï¼ï¼‰

å½“å‰è¿™ä¸ªç¡¬ç›˜ä¸‹æœ‰ä¸¤ä¸ªåˆ†åŒº `sda1` å’Œ `sda2`ï¼Œ`sda1` åˆ†åŒºä» `sda` ç£ç›˜è®¾å¤‡ä¸­ç”³è¯·äº† 100G ç©ºé—´ï¼Œ`sda2` åˆ†åŒºä¹Ÿä» `sda` ç£ç›˜è®¾å¤‡ä¸­ç”³è¯·äº† 100G ç©ºé—´ã€‚

éœ€è¦å¼ºè°ƒçš„ä¸€ç‚¹æ˜¯ï¼šç”³è¯·æˆåŠŸçš„ç©ºé—´æ‰æ˜¯æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨çš„åŒºåŸŸï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬èƒ½å¤ŸçœŸæ­£ä½¿ç”¨çš„å¤§å°å°±åªæœ‰ 200Gï¼Œå‰©ä¸‹çš„ 700G å°±æ˜¯è¿™å—ç¡¬ç›˜çš„å‰©ä½™ â€œå¯ç”³è¯·â€ çš„ç©ºé—´ï¼Œä¸‹é¢æ˜¯ç£ç›˜åˆ†åŒºæŠ½è±¡å›¾ã€‚

![sda-partition-1655527720BELZGO](http://linux-media.knowledge.ituknown.cn/Filesystem/DiskMgr/sda-partition-1655527720BELZGO.png)

å¦å¤–ï¼Œ`sda1` å’Œ `sda2` åˆ†åŒºè™½ç„¶éƒ½æ˜¯ä» `sda` ç£ç›˜ä¸Šåˆ’åˆ†å‡ºæ¥çš„ï¼Œä½†æ˜¯ `sda1` å’Œ `sda2` ä¹‹é—´æ˜¯ç‰©ç†éš”ç¦»çš„ï¼Œè¿™ä¸¤å—åˆ†åŒºä¹‹é—´æ•°æ®æ˜¯ä¸äº’é€šçš„ã€‚å¦‚æœä½ æƒ³åœ¨ `sda1` åˆ†åŒºä¸­å­˜å‚¨ 110G çš„æ•°æ®æ˜¯ä¸å¯èƒ½å®ç°çš„ï¼Œå› ä¸ºåœ¨åˆ’åˆ†åŒºçš„æ—¶å€™åªç»™ `sda1` åˆ†é…äº† 100G å¤§å°ç©ºé—´ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦é¢å¤–çš„æ³¨æ„ä¸€ä¸‹ã€‚

### ä»…åˆ—å‡ºç£ç›˜è®¾å¤‡æœ¬èº«, ä¸æ˜¾ç¤ºåˆ†åŒº

ä½¿ç”¨ `-d` å‚æ•°èƒ½å¤Ÿå¾ˆç›´è§‚çš„çœ‹åˆ°ç£ç›˜è®¾å¤‡çš„ç©ºé—´å¤§å°ï¼ˆå¦‚ä¸‹ï¼‰ï¼Œå½“ç„¶äº†ï¼Œåœ¨å®é™…ä¸Šè¿˜æ˜¯ä»¥ `lsblk -a` å’Œ `lsblk` ä¸ºä¸»ã€‚

```bash
$ lsblk -d
NAME  MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
loop0   7:0    0  43.6M  1 loop /snap/snapd/14978
loop1   7:1    0 164.8M  1 loop /snap/gnome-3-28-1804/161
loop2   7:2    0     4K  1 loop /snap/bare/5
loop3   7:3    0  65.2M  1 loop /snap/gtk-common-themes/1519
loop4   7:4    0  55.5M  1 loop /snap/core18/2284
sda     8:0    0 931.5G  0 disk
sdb     8:16   0 223.6G  0 disk
```

### æ˜¾ç¤ºè®¾å¤‡çš„å®Œæ•´æ–‡ä»¶å(è·¯å¾„), è€Œä¸æ˜¯ä»…åˆ—å‡ºå…·ä½“çš„è®¾å¤‡å

å‰é¢çš„æ˜¾ç¤ºå‘½ä»¤éƒ½åªæ˜¾ç¤ºå…·ä½“è®¾å¤‡åï¼Œæ²¡æœ‰æ˜¾ç¤ºè®¾å¤‡çš„å…·ä½“ä½ç½®ï¼Œæ¯”å¦‚ `sda` è®¾å¤‡å…¶å®æ˜¯åœ¨ `/dev` ç›®å½•ä¸‹çš„ã€‚å¦‚æœæƒ³è¦æ˜¾ç¤ºè®¾å¤‡çš„å…·ä½“è·¯å¾„å¯ä»¥ä½¿ç”¨ `-p` å‚æ•°ï¼š

```bash
$ lsblk -p
NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
/dev/loop0    7:0    0  43.6M  1 loop /snap/snapd/14978
/dev/loop1    7:1    0 164.8M  1 loop /snap/gnome-3-28-1804/161
/dev/loop2    7:2    0     4K  1 loop /snap/bare/5
/dev/loop3    7:3    0  65.2M  1 loop /snap/gtk-common-themes/1519
/dev/loop4    7:4    0  55.5M  1 loop /snap/core18/2284
/dev/sda      8:0    0 931.5G  0 disk
|-/dev/sda1   8:1    0   100G  0 part
`-/dev/sda2   8:2    0   100G  0 part
/dev/sdb      8:16   0 223.6G  0 disk
|-/dev/sdb1   8:17   0   512M  0 part /boot/efi
|-/dev/sdb2   8:18   0 222.1G  0 part /
`-/dev/sdb3   8:19   0   976M  0 part [SWAP]
```

### åˆ—å‡ºç£ç›˜è®¾å¤‡çš„è¯¦ç»†æ•°æ®

`-t` å‚æ•°ä¸€åŠä½¿ç”¨çš„æ¯”è¾ƒå°‘ï¼Œä¸è¿‡å¯ä»¥æ›´è¯¦ç»†çš„æ˜¾ç¤ºç£ç›˜è®¾å¤‡ä¿¡æ¯ï¼Œå¦‚ç£ç›˜é˜µåˆ—æœºåˆ¶ç­‰ï¼š

```bash
$ lsblk -t
NAME   ALIGNMENT MIN-IO OPT-IO PHY-SEC LOG-SEC ROTA SCHED       RQ-SIZE  RA WSAME
loop0          0    512      0     512     512    0 mq-deadline     256 128    0B
loop1          0    512      0     512     512    0 mq-deadline     256 128    0B
loop2          0    512      0     512     512    0 mq-deadline     256 128    0B
loop3          0    512      0     512     512    0 mq-deadline     256 128    0B
loop4          0    512      0     512     512    0 mq-deadline     256 128    0B
sda            0   4096      0    4096     512    1 mq-deadline      64 128    0B
|-sda1         0   4096      0    4096     512    1 mq-deadline      64 128    0B
`-sda2         0   4096      0    4096     512    1 mq-deadline      64 128    0B
sdb            0    512      0     512     512    0 mq-deadline      64 128    0B
|-sdb1         0    512      0     512     512    0 mq-deadline      64 128    0B
|-sdb2         0    512      0     512     512    0 mq-deadline      64 128    0B
`-sdb3         0    512      0     512     512    0 mq-deadline      64 128    0B
```

### ä»¥ JSON çš„æ•°æ®æ ¼å¼æ•°æ®

ä¸Šé¢è¾“å‡ºçš„ä¿¡æ¯å…¶å®å·²ç»å¾ˆç›´è§‚äº†ï¼Œä¸è¿‡å¦‚æœæƒ³è¦å°†è¿™äº›æ•°æ®å¯¼å‡ºæ¥æœ€å¥½è¿˜æ˜¯ä»¥æŸç§æ•°æ®ç»“æ„è¿›è¡Œå±•ç¤ºï¼Œæ¯”å¦‚ JSON æ•°æ®æ ¼å¼ï¼š

```bash
$ lsblk -J
{
   "blockdevices": [
      {"name":"loop0", "maj:min":"7:0", "rm":false, "size":"43.6M", "ro":true, "type":"loop", "mountpoint":"/snap/snapd/14978"},
      {"name":"loop1", "maj:min":"7:1", "rm":false, "size":"164.8M", "ro":true, "type":"loop", "mountpoint":"/snap/gnome-3-28-1804/161"},
      {"name":"loop2", "maj:min":"7:2", "rm":false, "size":"4K", "ro":true, "type":"loop", "mountpoint":"/snap/bare/5"},
      {"name":"loop3", "maj:min":"7:3", "rm":false, "size":"65.2M", "ro":true, "type":"loop", "mountpoint":"/snap/gtk-common-themes/1519"},
      {"name":"loop4", "maj:min":"7:4", "rm":false, "size":"55.5M", "ro":true, "type":"loop", "mountpoint":"/snap/core18/2284"},
      {"name":"sda", "maj:min":"8:0", "rm":false, "size":"931.5G", "ro":false, "type":"disk", "mountpoint":null,
         "children": [
            {"name":"sda1", "maj:min":"8:1", "rm":false, "size":"100G", "ro":false, "type":"part", "mountpoint":null},
            {"name":"sda2", "maj:min":"8:2", "rm":false, "size":"100G", "ro":false, "type":"part", "mountpoint":null}
         ]
      },
      {"name":"sdb", "maj:min":"8:16", "rm":false, "size":"223.6G", "ro":false, "type":"disk", "mountpoint":null,
         "children": [
            {"name":"sdb1", "maj:min":"8:17", "rm":false, "size":"512M", "ro":false, "type":"part", "mountpoint":"/boot/efi"},
            {"name":"sdb2", "maj:min":"8:18", "rm":false, "size":"222.1G", "ro":false, "type":"part", "mountpoint":"/"},
            {"name":"sdb3", "maj:min":"8:19", "rm":false, "size":"976M", "ro":false, "type":"part", "mountpoint":"[SWAP]"}
         ]
      }
   ]
}
```

### æ˜¾ç¤ºé¢å¤–çš„åˆ—ä¿¡æ¯

é»˜è®¤æƒ…å†µä¸‹ï¼Œ`lsblk` å‘½ä»¤ä»…ä»…å±•ç¤ºæŸå‡ åˆ—æ•°æ®ï¼Œå¦‚ Nameã€SIZEã€ROã€TYPEï¼š

```bash
$ lsblk
NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
loop0    7:0    0  43.6M  1 loop /snap/snapd/14978
loop1    7:1    0 164.8M  1 loop /snap/gnome-3-28-1804/161
loop2    7:2    0     4K  1 loop /snap/bare/5
loop3    7:3    0  65.2M  1 loop /snap/gtk-common-themes/1519
loop4    7:4    0  55.5M  1 loop /snap/core18/2284
sda      8:0    0 931.5G  0 disk
|-sda1   8:1    0   100G  0 part
`-sda2   8:2    0   100G  0 part
sdb      8:16   0 223.6G  0 disk
|-sdb1   8:17   0   512M  0 part /boot/efi
|-sdb2   8:18   0 222.1G  0 part /
`-sdb3   8:19   0   976M  0 part [SWAP]
```

å…¶å®ï¼Œå¯æ˜¾ç¤ºçš„åˆ—è¿œä¸æ­¢è¿™äº›ï¼Œè¿˜æœ‰å¦‚ UUIDã€LABEL ç­‰åˆ—ã€‚å¦‚æœæƒ³è¦æŸ¥çœ‹å…·ä½“æœ‰å“ªäº›åˆ—ï¼Œå¯ä»¥ä½¿ç”¨ `--help` å’Œ `man` å‘½ä»¤æŸ¥çœ‹ï¼Œè¿™é‡Œä¸åšè¯´æ˜äº†ã€‚

æƒ³è¦æ˜¾ç¤ºé¢å¤–çš„æŒ‡å®šåˆ—ï¼Œå¯ä»¥ä½¿ç”¨ `-o` å‚æ•°ï¼Œ`+` è¡¨ç¤ºå¢åŠ æ˜¾ç¤ºåˆ—ï¼Œå¦åˆ™è¡¨ç¤ºä»…æ˜¾ç¤ºæŒ‡å®šåˆ—ã€‚ä»–çš„è¯­æ³•å¦‚ä¸‹ï¼š

```bash
$ lsblk -o [+][column,column...] [device...]
```

æ¯”å¦‚æˆ‘æƒ³é¢å¤–æ˜¾ç¤º UUIDã€LABELï¼Œåˆ™å‘½ä»¤å¦‚ä¸‹ï¼š

```bash
$ lsblk -o +UUID,LABEL
NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT                   UUID                                 LABEL
loop0    7:0    0  43.6M  1 loop /snap/snapd/14978
loop1    7:1    0 164.8M  1 loop /snap/gnome-3-28-1804/161
loop2    7:2    0     4K  1 loop /snap/bare/5
loop3    7:3    0  65.2M  1 loop /snap/gtk-common-themes/1519
loop4    7:4    0  55.5M  1 loop /snap/core18/2284
sda      8:0    0 931.5G  0 disk
|-sda1   8:1    0   100G  0 part
`-sda2   8:2    0   100G  0 part
sdb      8:16   0 223.6G  0 disk
|-sdb1   8:17   0   512M  0 part /boot/efi                    D8C7-8235
|-sdb2   8:18   0 222.1G  0 part /                            042055c6-546b-4889-8d3f-3b7aec794412
`-sdb3   8:19   0   976M  0 part [SWAP]                       660f3d0e-0a77-4d60-8532-b867c3a9e0d8
```

## blkid æ˜¾ç¤ºåˆ†åŒº UUID

`blkid` æˆ‘åœ¨ä½¿ç”¨æ—¶æœ€ä¸»è¦å°±æ˜¯ç”¨äºæ˜¾ç¤ºåˆ†åŒºçš„ UUIDï¼Œå› ä¸ºåœ¨åšè®¾å¤‡æŒ‚è½½æ—¶è™½ç„¶èƒ½å¤Ÿç›´æ¥ä½¿ç”¨è®¾å¤‡åï¼Œä½†æ˜¯æˆ‘æ›´å»ºè®®ä½¿ç”¨åˆ†åŒºçš„ UUIDã€‚

`blkid` å·¥å…·å°±æ¯”è¾ƒç®€å•äº†ï¼Œç›´æ¥è¾“å…¥å³å¯ï¼ˆåœ¨æŸäº› Linux å‘è¡Œç‰ˆï¼Œæ™®é€šç”¨æˆ·æ˜¯æ²¡æœ‰æƒé™ä½¿ç”¨è¯¥å‘½ä»¤çš„ï¼Œéœ€è¦å€ŸåŠ© `sudo`ï¼‰ï¼š

```bash
$ sudo blkid
/dev/sdb1: UUID="D8C7-8235" BLOCK_SIZE="512" TYPE="vfat" PARTUUID="8591882f-1b8b-44ed-a33b-f539f356e802"
/dev/sdb2: UUID="042055c6-546b-4889-8d3f-3b7aec794412" BLOCK_SIZE="4096" TYPE="ext4" PARTUUID="016e491b-23c1-45f0-99a4-7a6d440e1aac"
/dev/sdb3: UUID="660f3d0e-0a77-4d60-8532-b867c3a9e0d8" TYPE="swap" PARTUUID="35cd0ea7-73db-463e-aad9-136e916b01c9"
/dev/loop0: TYPE="squashfs"
/dev/loop1: TYPE="squashfs"
/dev/loop2: TYPE="squashfs"
/dev/loop3: TYPE="squashfs"
/dev/loop4: TYPE="squashfs"
/dev/sda1: PARTLABEL="Linux filesystem" PARTUUID="a1ac0702-797d-4ebb-94b1-b0f7e0cb0ee2"
/dev/sda2: PARTLABEL="Linux filesystem" PARTUUID="a942b1c6-5058-4820-a9bf-b6231ead20cc"
```

å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘çš„ `/dev/sdb1` åˆ†åŒºå¯¹åº”çš„åˆ†åŒº UUID å°±æ˜¯ `a1ac0702-797d-4ebb-94b1-b0f7e0cb0ee2`ï¼Œè¿™ä¸ªä¿¡æ¯åœ¨åšç³»ç»ŸæŒ‚è½½æ—¶å¾ˆæœ‰ç”¨çš„ã€‚

å½“ç„¶äº†ï¼Œå…¶å®ä½¿ç”¨ `lsblk` å‘½ä»¤ä¹Ÿæ˜¯å¯ä»¥èƒ½å¤Ÿå®ç°æ˜¾ç¤ºåˆ†åŒº UUID çš„ï¼ˆå¦‚ä¸‹ï¼‰ï¼Œåªä¸è¿‡æ²¡æœ‰ `blkid` ç”¨èµ·æ¥æ–¹ä¾¿ã€‚

```bash
$ lsblk -o +PARTUUID
```

## parted æŸ¥çœ‹åˆ†åŒºç±»å‹å’Œæ•°æ®

åœ¨å¼€å§‹çš„æ—¶å€™å°±è¯´äº†åˆ†åŒºæ ¼å¼æœ‰ GPT å’Œ MBR ä¸¤ç§ï¼Œä½†æ˜¯åˆ°ç°åœ¨ä¸ºæ­¢å±•ç¤ºçš„ä¸€ç›´æ˜¯ç£ç›˜è®¾å¤‡çš„è¾…åŠ©ä¿¡æ¯ï¼Œå¦‚ä½•æŸ¥çœ‹åˆ†åŒºæ ¼å¼å‘¢ï¼Ÿå½“ç„¶è¿˜æ˜¯éœ€è¦ä½¿ç”¨ `parted` å·¥å…·äº†ã€‚

`parted` å¸¸ç”¨è¯­æ³•å¦‚ä¸‹ï¼š

```bash
$ parted -l
$ parted device_name print
```

å…¶ä¸­ï¼Œ`-l` å‘½ä»¤ç”¨äºåˆ—å‡ºæ‰€æœ‰è®¾å¤‡åˆ†åŒºä¿¡æ¯ï¼ˆä¸åŒ…æ‹¬ loop è®¾å¤‡ï¼‰ï¼Œè€Œåä¸€ä¸ªå‘½ä»¤åˆ™ç”¨äºä»…æ˜¾ç¤ºæŒ‡å®šè®¾å¤‡çš„åˆ†åŒºä¿¡æ¯ã€‚ç°åœ¨æ¥ä½¿ç”¨è¯¥å·¥å…·çœ‹ä¸‹ `/dev/sda` è®¾å¤‡åˆ†åŒºä¿¡æ¯ï¼š

```bash
$ sudo parted /dev/sda print

Model: ATA ST1000LM048-2E71 (scsi)                 # ç£ç›˜å‹å·å‚å•†(å¸Œæ·)
Disk /dev/sda: 1000GB                              # ç£ç›˜å¤§å°
Sector size (logical/physical): 512B/4096B         # æ¯ä¸ªç‰©ç†æ‰‡åŒºå¤§å°
Partition Table: gpt                               # åˆ†åŒºæ ¼å¼ GPT
Disk Flags:
                                                   # ä¸‹é¢æ‰æ˜¯åˆ†åŒºæ•°æ®
Number  Start   End    Size   File system  Name              Flags
 1      1049kB  107GB  107GB               Linux filesystem
 2      107GB   215GB  107GB               Linux filesystem
```

æ‰€ä»¥ï¼Œæˆ‘å½“å‰è¿™å—æœºæ¢°ç¡¬ç›˜çš„åˆ†åŒºæ ¼å¼æ˜¯ GPTã€‚

# gdisk ç®¡ç† GPT æ ¼å¼åˆ†åŒº

å†æ¬¡å¼ºè°ƒï¼Œç®¡ç†ç£ç›˜åˆ†åŒºçš„å·¥å…·ä¸»è¦æœ‰ `gdisk` å’Œ `fdisk`ï¼Œåˆ†åˆ«é€‚ç”¨äº GPT åˆ†åŒºæ ¼å¼å’Œ MBR åˆ†åŒºæ ¼å¼ã€‚å¦‚æœä½ çš„ç£ç›˜åˆ†åŒºæ˜¯ GPT é‚£ä¹ˆå°±ä½¿ç”¨ `gdisk` å·¥å…·ï¼Œå¦åˆ™å°±ä½¿ç”¨ `fdisk` å·¥å…·ï¼Œæœ€å¥½ä¸è¦æ··ç”¨ï¼Œä»¥å…é€ æˆæ•°æ®ä¸¢å¤±çš„åæœã€‚

`gdisk` å·¥å…·è¯­æ³•å¦‚ä¸‹ï¼š

```bash
$ gdisk [-l] device
```

å¦‚æœæŒ‡å®šäº† `-l` å‚æ•°åˆ™ç”¨äºæ˜¾ç¤ºè®¾å¤‡çš„ä¿¡æ¯ï¼Œä»¥ `/dev/sda` ä¸ºä¾‹ï¼š

```bash
$ sudo gdisk -l /dev/sda
GPT fdisk (gdisk) version 1.0.6

Partition table scan:
  MBR: protective
  BSD: not present
  APM: not present
  GPT: present     # è¡¨ç¤ºå½“å‰ç£ç›˜æ˜¯ GPT åˆ†åŒº

Found valid GPT with protective MBR; using GPT.
Disk /dev/sda: 1953525168 sectors, 931.5 GiB
Model: ST1000LM048-2E71
Sector size (logical/physical): 512/4096 bytes
Disk identifier (GUID): 3FD2DD42-E48F-42AA-B691-F84F18580A8F  # è¿™é‡Œæ˜¾ç¤ºçš„æ˜¯è®¾å¤‡çš„ UUID, ä¸æ˜¯åˆ†åŒºè¡¨
Partition table holds up to 128 entries
Main partition table begins at sector 2 and ends at sector 33
First usable sector is 34, last usable sector is 1953525134
Partitions will be aligned on 2048-sector boundaries
Total free space is 1534094701 sectors (731.5 GiB)
# åˆ†åŒºæ•°æ®(1è¡¨ç¤ºçš„å°±æ˜¯ sda1, 2è¡¨ç¤ºçš„å°±æ˜¯ sda2)
Number  Start (sector)    End (sector)  Size       Code  Name
   1            2048       209717247   100.0 GiB   8300  Linux filesystem
   2       209717248       419432447   100.0 GiB   8300  Linux filesystem
```

ä¸‹é¢æ¥çœ‹ä¸‹å…·ä½“æ“ä½œï¼š

## gdisk å‚æ•°è¯´æ˜

```bash
$ sudo gdisk /dev/sda
GPT fdisk (gdisk) version 1.0.6

Partition table scan:
  MBR: protective
  BSD: not present
  APM: not present
  GPT: present

Found valid GPT with protective MBR; using GPT.  # GPT åˆ†åŒº

Command (? for help):  # è¾“å…¥å‘½ä»¤æ‰§è¡Œæ‰åš, ? æ¥çœ‹ä¸‹æœ‰å“ªäº›å‘½ä»¤
```

å½“æˆ‘ä»¬é”®å…¥ `?` åæ˜¾ç¤ºå¦‚ä¸‹ï¼š

```bash
Command (? for help): ?
b	back up GPT data to a file
c	change a partition's name
d	delete a partition              <===============   # åˆ é™¤åˆ†åŒº
i	show detailed information on a partition
l	list known partition types
n	add a new partition             <===============   # åˆ›å»ºæ–°åˆ†åŒº
o	create a new empty GUID partition table (GPT)
p	print the partition table       <===============   # æ˜¾ç¤ºå½“å‰åˆ†åŒºè¡¨ä¿¡æ¯
q	quit without saving changes     <===============   # ç›´æ¥é€€å‡º, æ”¾å¼ƒä¿®æ”¹çš„ç»“æœ
r	recovery and transformation options (experts only) # è¿›å…¥æ¢å¤æ¨¡å¼
s	sort partitions
t	change a partition's type code
v	verify disk                     <===============   # éªŒè¯åˆ†åŒºä¿®æ”¹ç»“æœ
w	write table to disk and exit    <===============   # ä¿å­˜ä¿®æ”¹çš„æ“ä½œå¹¶é€€å‡º
x	extra functionality (experts only)
?	print this menu

Command (? for help):
```

å…¶å®ä¸Šé¢æ˜¾ç¤ºçš„å·²ç»å¾ˆæ¸…æ™°äº†ï¼Œæˆ‘ä»¬åªéœ€è¦æŒ‰ç…§è¯´æ˜å‚»ç“œå¼çš„æ“ä½œå³å¯ã€‚å¦å¤–ï¼Œæœ‰ä¸¤ä¸ªå‚æ•°éœ€è¦ç‰¹åˆ«è¯´æ˜ï¼š

`q` è¡¨ç¤ºçš„ä¸ä¿å­˜ä¿®æ”¹ç»“æœï¼Œç›´æ¥é€€å‡º gdiskï¼ˆå¦‚æœæ˜¯ä¸ªäººå­¦ä¹ çš„è¯å»ºè®®ä½¿ç”¨è¿™ä¸ªï¼‰ã€‚

`w` è¡¨ç¤ºçš„ä¿å­˜ä¿®æ”¹ç»“æœå¹¶é€€å‡º gdiskã€‚

## æ˜¾ç¤ºåˆ†åŒºè¡¨ä¿¡æ¯

```bash
Command (? for help): p
Disk /dev/sda: 1953525168 sectors, 931.5 GiB
Model: ST1000LM048-2E71
Sector size (logical/physical): 512/4096 bytes
Disk identifier (GUID): 3FD2DD42-E48F-42AA-B691-F84F18580A8F
Partition table holds up to 128 entries
Main partition table begins at sector 2 and ends at sector 33
First usable sector is 34, last usable sector is 1953525134
Partitions will be aligned on 2048-sector boundaries
Total free space is 1534094701 sectors (731.5 GiB)

Number  Start (sector)    End (sector)  Size       Code  Name
   1            2048       209717247   100.0 GiB   8300  Linux filesystem
   2       209717248       419432447   100.0 GiB   8300  Linux filesystem

Command (? for help):
```

## åˆ é™¤åˆ†åŒºè¡¨

```bash
Command (? for help): d    # d å‘½ä»¤åˆ é™¤
Partition number (1-2): 2  # è¾“å…¥æŒ‡å®šåˆ†åŒºç¼–å·

Command (? for help): p    # æŸ¥çœ‹ä¿®æ”¹åçš„åˆ†åŒºä¿¡æ¯
Disk /dev/sda: 1953525168 sectors, 931.5 GiB
Model: ST1000LM048-2E71
Sector size (logical/physical): 512/4096 bytes
Disk identifier (GUID): 3FD2DD42-E48F-42AA-B691-F84F18580A8F
Partition table holds up to 128 entries
Main partition table begins at sector 2 and ends at sector 33
First usable sector is 34, last usable sector is 1953525134
Partitions will be aligned on 2048-sector boundaries
Total free space is 1743809901 sectors (831.5 GiB)
                           # æ­¤æ—¶è¿˜æœ‰ä¸€ä¸ªåˆ†åŒº
Number  Start (sector)    End (sector)  Size       Code  Name
   1            2048       209717247   100.0 GiB   8300  Linux filesystem

Command (? for help): d    # ç»§ç»­åˆ é™¤
Using 1                    # å› ä¸ºåªæœ‰ä¸€ä¸ªåˆ†åŒºäº†, æ‰€ä»¥å°±ç›´æ¥åˆ é™¤æ‰äº†

Command (? for help): p    # å†çœ‹ä¸‹ä¿®æ”¹åçš„åˆ†åŒºä¿¡æ¯
Disk /dev/sda: 1953525168 sectors, 931.5 GiB
Model: ST1000LM048-2E71
Sector size (logical/physical): 512/4096 bytes
Disk identifier (GUID): 3FD2DD42-E48F-42AA-B691-F84F18580A8F
Partition table holds up to 128 entries
Main partition table begins at sector 2 and ends at sector 33
First usable sector is 34, last usable sector is 1953525134
Partitions will be aligned on 2048-sector boundaries
Total free space is 1953525101 sectors (931.5 GiB) # æ­¤æ—¶å¾…åˆ†é…çš„ç©ºé—´åˆå˜æˆ 1T äº†

Number  Start (sector)    End (sector)  Size       Code  Name
```

æ³¨æ„ï¼Œ`d` è™½ç„¶æ˜¯åˆ†åŒºå‘½ä»¤ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æ‰§è¡Œä¿å­˜æ“ä½œã€‚æ­¤æ—¶æˆ‘ä»¬è¾“å…¥ `q` é€€å‡ºçš„è¯æ˜¯æ²¡æœ‰ä»»ä½•å˜åŒ–çš„ï¼Œåªæœ‰ `w` ä¿å­˜æ‰ä¼šç”Ÿæ•ˆã€‚

## åˆ›å»ºåˆ†åŒºè¡¨

ä»”ç»†çœ‹ä¸‹é¢çš„æ“ä½œï¼Œè¿ç»­åˆ›å»º3ä¸ªåˆ†åŒºï¼š

```bash
Command (? for help): n   # åˆ›å»ºç¬¬ä¸€ä¸ªåˆ†åŒº
Partition number (1-128, default 1):  # æœ€å¤§å…è®¸åˆ†åŒºç¼–å·æ˜¯ 128, å½“å‰è¿˜æ²¡æœ‰ä»»ä½•åˆ†åŒº, æ‰€ä»¥é»˜è®¤ä¸º 1. å¯¹åº”çš„åˆ†åŒºè®¾å¤‡å°±æ˜¯ sda1
First sector (34-1953525134, default = 2048) or {+-}size{KMGTP}:  # åˆ†åŒºå¼€å§‹ä½ç½®, é»˜è®¤å³å¯
Last sector (2048-1953525134, default = 1953525134) or {+-}size{KMGTP}: +100G  # åˆ†åŒºç»“æŸä½ç½®, å¯ä»¥è¾“å…¥å…·ä½“æŒ‡, ä¹Ÿå¯ä»¥æ˜¯å®¹é‡å•ä½, å‰é¢å¿…é¡»æœ‰ + ç¬¦å·
Current type is 8300 (Linux filesystem)
Hex code or GUID (L to show codes, Enter = 8300):  # 8300 Linuxé»˜è®¤ç³»ç»Ÿæ ¼å¼
Changed type of partition to 'Linux filesystem'

Command (? for help): p   # çœ‹ä¸‹åˆ†åŒºä¿¡æ¯
Disk /dev/sda: 1953525168 sectors, 931.5 GiB
Model: ST1000LM048-2E71
Sector size (logical/physical): 512/4096 bytes
Disk identifier (GUID): 3FD2DD42-E48F-42AA-B691-F84F18580A8F
Partition table holds up to 128 entries
Main partition table begins at sector 2 and ends at sector 33
First usable sector is 34, last usable sector is 1953525134
Partitions will be aligned on 2048-sector boundaries
Total free space is 1743809901 sectors (831.5 GiB)    # å‰©ä½™å¯åˆ†é…ç©ºé—´

Number  Start (sector)    End (sector)  Size       Code  Name
   1            2048       209717247   100.0 GiB   8300  Linux filesystem  # ç¬¬ä¸€ä¸ªåˆ†åŒº, å¤§å° 100G

Command (? for help): n   # åˆ›å»ºç¬¬äºŒä¸ªåˆ†åŒº
Partition number (2-128, default 2):   # é»˜è®¤
First sector (34-1953525134, default = 209717248) or {+-}size{KMGTP}: # é»˜è®¤
Last sector (209717248-1953525134, default = 1953525134) or {+-}size{KMGTP}: +300G # ç¬¬äºŒä¸ªåˆ†åŒºå¤§å°ä¸º 300G
Current type is 8300 (Linux filesystem)
Hex code or GUID (L to show codes, Enter = 8300): # é»˜è®¤ Linux ç³»ç»Ÿæ ¼å¼
Changed type of partition to 'Linux filesystem'

Command (? for help): p # å†çœ‹ä¸‹åˆ†åŒºä¿¡æ¯
Disk /dev/sda: 1953525168 sectors, 931.5 GiB
Model: ST1000LM048-2E71
Sector size (logical/physical): 512/4096 bytes
Disk identifier (GUID): 3FD2DD42-E48F-42AA-B691-F84F18580A8F
Partition table holds up to 128 entries
Main partition table begins at sector 2 and ends at sector 33
First usable sector is 34, last usable sector is 1953525134
Partitions will be aligned on 2048-sector boundaries
Total free space is 1114664301 sectors (531.5 GiB)

Number  Start (sector)    End (sector)  Size       Code  Name
   1            2048       209717247   100.0 GiB   8300  Linux filesystem
   2       209717248       838862847   300.0 GiB   8300  Linux filesystem  # ç¬¬äºŒä¸ªåˆ†åŒºå¤§å°ä¸º 300G

Command (? for help): n # åˆ›å»ºç¬¬ä¸‰ä¸ªåˆ†åŒº
Partition number (3-128, default 3):
First sector (34-1953525134, default = 838862848) or {+-}size{KMGTP}:
Last sector (838862848-1953525134, default = 1953525134) or {+-}size{KMGTP}:  # æ³¨æ„è¿™é‡Œ, æ²¡æœ‰æŒ‡å®šåˆ†åŒºå¤§å°, é»˜è®¤ä¼šå–æœ€å¤§å€¼
Current type is 8300 (Linux filesystem)
Hex code or GUID (L to show codes, Enter = 8300):
Changed type of partition to 'Linux filesystem'

Command (? for help): p
Disk /dev/sda: 1953525168 sectors, 931.5 GiB
Model: ST1000LM048-2E71
Sector size (logical/physical): 512/4096 bytes
Disk identifier (GUID): 3FD2DD42-E48F-42AA-B691-F84F18580A8F
Partition table holds up to 128 entries
Main partition table begins at sector 2 and ends at sector 33
First usable sector is 34, last usable sector is 1953525134
Partitions will be aligned on 2048-sector boundaries
Total free space is 2014 sectors (1007.0 KiB)

Number  Start (sector)    End (sector)  Size       Code  Name
   1            2048       209717247   100.0 GiB   8300  Linux filesystem
   2       209717248       838862847   300.0 GiB   8300  Linux filesystem
   3       838862848      1953525134   531.5 GiB   8300  Linux filesystem   # å› ä¸ºç¬¬ä¸‰æ¬¡æ²¡æœ‰æŒ‡å®šåˆ†åŒºå¤§å°, æ‰€ä»¥å°†å‰©ä½™çš„å…¨éƒ¨å¯åˆ†é…ç©ºé—´å…¨éƒ¨åˆ†é…äº†
```

## ä¿å­˜åˆ†åŒºè¡¨

åˆ†åŒºåˆ›å»ºå®Œæˆä¹‹åå°±å¯ä»¥ä¿å­˜é€€å‡ºäº†ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªé€‰æ‹©ï¼šä¸ä¿å­˜ä¿®æ”¹ç»“æœç›´æ¥é€€å‡º `q` å’Œ ä¿å­˜ä¿®æ”¹ç»“æœå¹¶é€€å‡º `w`ã€‚

ç°åœ¨æ¥ä½¿ç”¨ `w`ï¼š

```bash
Command (? for help): w

Final checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING
PARTITIONS!!

Do you want to proceed? (Y/N): y  # ç¡®è®¤ä¿®æ”¹
OK; writing new GUID partition table (GPT) to /dev/sda.
The operation has completed successfully.
```

å½“ä¿å­˜ä¹‹åå°±å¯ä»¥ä½¿ç”¨ `parted` å·¥å…·æˆ– `gdisk` å·¥å…·å†æ¥çœ‹ä¸‹ `/dev/sda` è®¾å¤‡åˆ†åŒºä¿¡æ¯äº†ï¼š

**parted å·¥å…·è¾“å‡ºç¤ºä¾‹ï¼š**

```bash
$ sudo parted /dev/sda print
Model: ATA ST1000LM048-2E71 (scsi)
Disk /dev/sda: 1000GB
Sector size (logical/physical): 512B/4096B
Partition Table: gpt
Disk Flags:

Number  Start   End     Size   File system  Name              Flags
 1      1049kB  107GB   107GB               Linux filesystem
 2      107GB   429GB   322GB               Linux filesystem
 3      429GB   1000GB  571GB               Linux filesystem
```

**gdisk å·¥å…·è¾“å‡ºç¤ºä¾‹ï¼š**

```bash
$ sudo gdisk -l /dev/sda
GPT fdisk (gdisk) version 1.0.6

Partition table scan:
  MBR: protective
  BSD: not present
  APM: not present
  GPT: present

Found valid GPT with protective MBR; using GPT.
Disk /dev/sda: 1953525168 sectors, 931.5 GiB
Model: ST1000LM048-2E71
Sector size (logical/physical): 512/4096 bytes
Disk identifier (GUID): 3FD2DD42-E48F-42AA-B691-F84F18580A8F
Partition table holds up to 128 entries
Main partition table begins at sector 2 and ends at sector 33
First usable sector is 34, last usable sector is 1953525134
Partitions will be aligned on 2048-sector boundaries
Total free space is 2014 sectors (1007.0 KiB)

Number  Start (sector)    End (sector)  Size       Code  Name
   1            2048       209717247   100.0 GiB   8300  Linux filesystem
   2       209717248       838862847   300.0 GiB   8300  Linux filesystem
   3       838862848      1953525134   531.5 GiB   8300  Linux filesystem
```

ä¸ç®¡å“ªä¸ªå·¥å…·ï¼Œæˆ‘ä»¬éƒ½èƒ½çœ‹åˆ°ç›¸åŒçš„ç»“æœã€‚åˆ°æ­¤ï¼Œåˆ†åŒºå°±ä¿®æ”¹å®Œæˆäº†~

## GPT è½¬ MBR æ ¼å¼

åˆ†åŒºæ ¼å¼å…¶å®æ˜¯å¯ä»¥è½¬æ¢çš„ï¼Œè¿˜è®°å¾— `?` å‘½ä»¤é‡Œé¢æœ‰ä¸ªæ¢å¤æ¨¡å¼ `r` å‘½ä»¤ï¼Ÿç°åœ¨æ¥çœ‹ä¸‹å°† GPT è½¬ MBR åˆ†åŒºï¼š

```bash
$ sudo gdisk /dev/sda
GPT fdisk (gdisk) version 1.0.6

Partition table scan:
  MBR: protective
  BSD: not present
  APM: not present
  GPT: present

Found valid GPT with protective MBR; using GPT.

Command (? for help): ?
b	back up GPT data to a file
c	change a partition's name
d	delete a partition
i	show detailed information on a partition
l	list known partition types
n	add a new partition
o	create a new empty GUID partition table (GPT)
p	print the partition table
q	quit without saving changes
r	recovery and transformation options (experts only)   # r æ¢å¤æ¨¡å¼
s	sort partitions
t	change a partition's type code
v	verify disk
w	write table to disk and exit
x	extra functionality (experts only)
?	print this menu

Command (? for help): r  # r å‘½ä»¤

Recovery/transformation command (? for help): ? # çœ‹ä¸‹æ¢å¤æ¨¡å¼æœ‰å“ªäº›å‘½ä»¤
b	use backup GPT header (rebuilding main)
c	load backup partition table from disk (rebuilding main)
d	use main GPT header (rebuilding backup)
e	load main partition table from disk (rebuilding backup)
f	load MBR and build fresh GPT from it
g	convert GPT into MBR and exit  # GPT è½¬ MBR å‘½ä»¤
h	make hybrid MBR
i	show detailed information on a partition
l	load partition data from a backup file
m	return to main menu
o	print protective MBR data
p	print the partition table
q	quit without saving changes
t	transform BSD disklabel partition
v	verify disk
w	write table to disk and exit
x	extra functionality (experts only)
?	print this menu

Recovery/transformation command (? for help): g # GPT è½¬ MBR

MBR command (? for help): ?   # æ³¨æ„çœ‹, æ­¤æ—¶å·²ç»å˜æˆ MBR äº†
a	toggle the active/boot flag
c	recompute all CHS values
l	set partition as logical
o	omit partition
p	print the MBR partition table
q	quit without saving changes
r	set partition as primary
s	sort MBR partitions
t	change partition type code
w	write the MBR partition table to disk and exit

MBR command (? for help): w # ä¿å­˜å¹¶é€€å‡º

Converted 3 partitions. Finalize and exit? (Y/N): y # ç¡®è®¤ä¿å­˜
GPT data structures destroyed! You may now partition the disk using fdisk or
other utilities.
```

ä¿å­˜ä¹‹åæœ€å¥½å†ä½¿ç”¨ `partprobe` å·¥å…·æ£€æŸ¥ä¿®å¤ä¸‹ï¼š

```bash
$ sudo partprobe
```

ç°åœ¨å†æ¥çœ‹ä¸‹åˆ†åŒºæ ¼å¼ï¼š

```bash
$ sudo gdisk -l /dev/sda
GPT fdisk (gdisk) version 1.0.6

Warning: Partition table header claims that the size of partition table
entries is 0 bytes, but this program  supports only 128-byte entries.
Adjusting accordingly, but partition table may be garbage.
Warning: Partition table header claims that the size of partition table
entries is 0 bytes, but this program  supports only 128-byte entries.
Adjusting accordingly, but partition table may be garbage.
Partition table scan:
  MBR: MBR only       # çœ‹è¿™é‡Œ, å˜æˆ MBR åˆ†åŒºäº†
  BSD: not present
  APM: not present
  GPT: not present


***************************************************************
Found invalid GPT and valid MBR; converting MBR to GPT format  # MBR åˆ†åŒº
in memory.
***************************************************************

Disk /dev/sda: 1953525168 sectors, 931.5 GiB
Model: ST1000LM048-2E71
Sector size (logical/physical): 512/4096 bytes
Disk identifier (GUID): 4E085E7E-5F9F-4E85-858E-3AE0871A5DBC
Partition table holds up to 128 entries
Main partition table begins at sector 2 and ends at sector 33
First usable sector is 34, last usable sector is 1953525134
Partitions will be aligned on 2048-sector boundaries
Total free space is 2014 sectors (1007.0 KiB)

Number  Start (sector)    End (sector)  Size       Code  Name
   1            2048       209717247   100.0 GiB   8300  Linux filesystem
   2       209717248       838862847   300.0 GiB   8300  Linux filesystem
   3       838862848      1953525134   531.5 GiB   8300  Linux filesystem
```

## MBR è½¬ GPT æ ¼å¼

æ—¢ç„¶ GPT èƒ½èµš MBRï¼Œé‚£ä¹ˆ MBR è‚¯å®šä¹Ÿèƒ½è½¬ GPT æ ¼å¼äº†ã€‚MBR è½¬ GPT æ ¼å¼ç®€ç›´ä¸è¦å¤ªç®€å•ï¼Œç›´æ¥ä¿å­˜å³å¯ï¼š

```bash
$ sudo gdisk /dev/sda
GPT fdisk (gdisk) version 1.0.6

Warning: Partition table header claims that the size of partition table
entries is 0 bytes, but this program  supports only 128-byte entries.
Adjusting accordingly, but partition table may be garbage.
Warning: Partition table header claims that the size of partition table
entries is 0 bytes, but this program  supports only 128-byte entries.
Adjusting accordingly, but partition table may be garbage.
Partition table scan:
  MBR: MBR only
  BSD: not present
  APM: not present
  GPT: not present


***************************************************************
Found invalid GPT and valid MBR; converting MBR to GPT format
in memory. THIS OPERATION IS POTENTIALLY DESTRUCTIVE! Exit by
typing 'q' if you don't want to convert your MBR partitions
to GPT format!
***************************************************************


Command (? for help): w # ç›´æ¥ä¿å­˜å°±ä¼šè½¬æ¢æˆ GPT åˆ†åŒºäº†

Final checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING
PARTITIONS!!

Do you want to proceed? (Y/N): y # ç¡®è®¤è½¬æ¢
OK; writing new GUID partition table (GPT) to /dev/sda.
The operation has completed successfully.
```

# fdisk ç®¡ç† MBR æ ¼å¼åˆ†åŒº

`fdisk` å·¥å…·ä¸ `gdisk` å·¥å…·æ˜¯ä¸€è‡´çš„ï¼Œéƒ½æ˜¯æŒ‰ç…§æç¤ºæ“ä½œå³å¯ã€‚ä¸è¿‡ `fdisk` æœ‰å‡ ä¸ªå¯ç”¨äºæŸ¥çœ‹ç£ç›˜ä¿¡æ¯çš„å‚æ•°ï¼Œè¿™é‡Œéœ€è¦è¯´æ˜ä¸‹ï¼š

```bash
$ fdisk [-lx] -o [+][column...] [device]

-l æ˜¾ç¤ºç£ç›˜è®¾å¤‡ä¿¡æ¯
-x æ˜¾ç¤ºç£ç›˜è®¾å¤‡è¯¦ç»†ä¿¡æ¯(æ¯” -l å¤šä¸€äº›)
-o æ˜¾ç¤ºæŒ‡å®šåˆ—æˆ–æ˜¾ç¤ºé¢å¤–åˆ—(ä¸ lsblk ä½¿ç”¨æ–¹å¼ä¸€æ ·)
```

å¦å¤–ï¼Œå¦‚æœä¸æŒ‡å®šå…·ä½“ç£ç›˜è®¾å¤‡ä¼šæ˜¾ç¤ºæ‰€æœ‰ç£ç›˜è®¾å¤‡æ•°æ®~

ä»¥ `/dev/sda` ä¸ºä¾‹ï¼š

## æ˜¾ç¤ºåˆ†åŒºä¿¡æ¯

**`-l` å‚æ•°åªä¼šæ˜¾ç¤ºåŸºæœ¬ä¿¡æ¯ï¼š**

```bash
$ sudo fdisk -l /dev/sda
Disk /dev/sda: 931.51 GiB, 1000204886016 bytes, 1953525168 sectors
Disk model: ST1000LM048-2E71
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes
Disklabel type: gpt
Disk identifier: E4FB3887-8182-4CC1-82F5-484D4B204F1B

Device         Start        End    Sectors   Size Type
/dev/sda1       2048  209717247  209715200   100G Linux filesystem
/dev/sda2  209717248  838862847  629145600   300G Linux filesystem
/dev/sda3  838862848 1953525134 1114662287 531.5G Linux filesystem
```

è€Œ `-x` åˆ™ä¼šæ˜¾ç¤ºåˆ†åŒºUUIDã€åç§°ç­‰æ•°æ®ï¼š

```bash
$ sudo fdisk -x /dev/sda
Disk /dev/sda: 931.51 GiB, 1000204886016 bytes, 1953525168 sectors
Disk model: ST1000LM048-2E71
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes
Disklabel type: gpt
Disk identifier: E4FB3887-8182-4CC1-82F5-484D4B204F1B
First LBA: 34
Last LBA: 1953525134
Alternative LBA: 1953525167
Partition entries LBA: 2
Allocated partition entries: 128

Device         Start        End    Sectors Type-UUID                            UUID                                 Name             Attrs
/dev/sda1       2048  209717247  209715200 0FC63DAF-8483-4772-8E79-3D69D8477DE4 8CEC377B-7907-4252-A34E-B96CF3F68009 Linux filesystem
/dev/sda2  209717248  838862847  629145600 0FC63DAF-8483-4772-8E79-3D69D8477DE4 2C541EF2-A66F-4321-A283-448AA74F6EAF Linux filesystem
/dev/sda3  838862848 1953525134 1114662287 0FC63DAF-8483-4772-8E79-3D69D8477DE4 A7855368-BD5F-467A-86C8-E22C48A08049 Linux filesystem
```

å…¶ä»–çš„å°±æ²¡å•¥å¥½è¯´çš„äº†~

## fdisk å‚æ•°è¯´æ˜

ä½¿ç”¨ `fdisk` ç®¡ç†ç£ç›˜åˆ†åŒºå‘½ä»¤ä¸ `gdisk` ä¸€è‡´ï¼Œå½“è¿›å…¥ `fdisk` åå°±ä¼šæç¤ºä½ å¦‚ä½•æ“ä½œäº†ï¼š

```bash
$ sudo fdisk /dev/sda

Welcome to fdisk (util-linux 2.36.1).
Changes will remain in memory only, until you decide to write them.
Be careful before using the write command.


Command (m for help):
```

å”¯ä¸€çš„åŒºåˆ«æ˜¯ `gdisk` çš„å¸®åŠ©å‘½ä»¤æ˜¯ `?`ï¼Œè€Œ `fdisk` çš„å¸®åŠ©å‘½ä»¤æ˜¯ `m`ï¼

å½“è¾“å…¥ `m` ä¹‹åå°±èƒ½çœ‹åˆ°æ‰€æœ‰å‘½ä»¤äº†ï¼š

```bash
Command (m for help): m

Help:

  GPT
   M   enter protective/hybrid MBR

  Generic
   d   delete a partition        # åˆ é™¤åˆ†åŒº
   F   list free unpartitioned space
   l   list known partition types
   n   add a new partition       # åˆ›å»ºä¿¡åˆ†åŒº
   p   print the partition table # æ˜¾ç¤ºå½“å‰åˆ†åŒºä¿¡æ¯
   t   change a partition type
   v   verify the partition table
   i   print information about a partition

  Misc
   m   print this menu
   x   extra functionality (experts only)

  Script
   I   load disk layout from sfdisk script file
   O   dump disk layout to sfdisk script file

  Save & Exit
   w   write table to disk and exit # ä¿å­˜å¹¶é€€å‡º
   q   quit without saving changes  # ä¸ä¿å­˜, ç›´æ¥é€€å‡º

  Create a new label
   g   create a new empty GPT partition table
   G   create a new empty SGI (IRIX) partition table
   o   create a new empty DOS partition table
   s   create a new empty Sun partition table
```

## æŸ¥çœ‹åˆ†åŒºè¡¨ä¿¡æ¯

è¿™é‡Œä¸ `gdisk` ä¸€è‡´ï¼Œå°±ä¸åšé¢å¤–è¯´æ˜äº†ï¼š

```bash
Command (m for help): p
Disk /dev/sda: 931.51 GiB, 1000204886016 bytes, 1953525168 sectors
Disk model: ST1000LM048-2E71
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes
Disklabel type: gpt
Disk identifier: E4FB3887-8182-4CC1-82F5-484D4B204F1B

Device         Start        End    Sectors   Size Type
/dev/sda1       2048  209717247  209715200   100G Linux filesystem
/dev/sda2  209717248  838862847  629145600   300G Linux filesystem
/dev/sda3  838862848 1953525134 1114662287 531.5G Linux filesystem
```

## åˆ é™¤åˆ†åŒºè¡¨

```bash
Command (m for help): p # æŸ¥çœ‹åˆ†åŒºè¡¨ä¿¡æ¯
Disk /dev/sda: 931.51 GiB, 1000204886016 bytes, 1953525168 sectors
Disk model: ST1000LM048-2E71
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes
Disklabel type: gpt
Disk identifier: E4FB3887-8182-4CC1-82F5-484D4B204F1B
                                                        # æœ‰ä¸‰ä¸ªåˆ†åŒºè¡¨
Device         Start        End    Sectors   Size Type
/dev/sda1       2048  209717247  209715200   100G Linux filesystem
/dev/sda2  209717248  838862847  629145600   300G Linux filesystem
/dev/sda3  838862848 1953525134 1114662287 531.5G Linux filesystem

Command (m for help): d  # åˆ é™¤åˆ†åŒºè¡¨
Partition number (1-3, default 3): # é»˜è®¤æœ€å¤§çš„é‚£ä¸ªåˆ†åŒºè¡¨

Partition 3 has been deleted.

Command (m for help): p
Disk /dev/sda: 931.51 GiB, 1000204886016 bytes, 1953525168 sectors
Disk model: ST1000LM048-2E71
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes
Disklabel type: gpt
Disk identifier: E4FB3887-8182-4CC1-82F5-484D4B204F1B
                                                        # ç°åœ¨åªæœ‰ä¸¤ä¸ªåˆ†åŒºè¡¨äº†
Device         Start       End   Sectors  Size Type
/dev/sda1       2048 209717247 209715200  100G Linux filesystem
/dev/sda2  209717248 838862847 629145600  300G Linux filesystem

Command (m for help): d # ç»§ç»­åˆ é™¤
Partition number (1,2, default 2):

Partition 2 has been deleted.

Command (m for help): p
Disk /dev/sda: 931.51 GiB, 1000204886016 bytes, 1953525168 sectors
Disk model: ST1000LM048-2E71
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes
Disklabel type: gpt
Disk identifier: E4FB3887-8182-4CC1-82F5-484D4B204F1B
                                                        # è¿˜ä¸€ä¸ªåˆ†åŒºè¡¨äº†
Device     Start       End   Sectors  Size Type
/dev/sda1   2048 209717247 209715200  100G Linux filesystem

Command (m for help): d # ç»§ç»­åˆ é™¤
Selected partition 1
Partition 1 has been deleted.

Command (m for help): p  # ç°åœ¨å°±æ²¡æœ‰åˆ†åŒºè¡¨äº†
Disk /dev/sda: 931.51 GiB, 1000204886016 bytes, 1953525168 sectors
Disk model: ST1000LM048-2E71
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes
Disklabel type: gpt
Disk identifier: E4FB3887-8182-4CC1-82F5-484D4B204F1B
```

## åˆ›å»ºåˆ†åŒºè¡¨

```bash
Command (m for help): n # åˆ›å»ºåˆ†åŒºè¡¨
Partition number (1-128, default 1):  # é»˜è®¤ç¬¬ä¸€ä¸ªåˆ†åŒºè¡¨ç¼–å·æ˜¯ 1
First sector (34-1953525134, default 2048): # ä¸ GPT ä¸€è‡´
Last sector, +/-sectors or +/-size{K,M,G,T,P} (2048-1953525134, default 1953525134): +200G # åˆ†é… 200G ç©ºé—´

Created a new partition 1 of type 'Linux filesystem' and of size 200 GiB.

Command (m for help): p # æŸ¥çœ‹åˆ†åŒºè¡¨
Disk /dev/sda: 931.51 GiB, 1000204886016 bytes, 1953525168 sectors
Disk model: ST1000LM048-2E71
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes
Disklabel type: gpt
Disk identifier: E4FB3887-8182-4CC1-82F5-484D4B204F1B

Device     Start       End   Sectors  Size Type
/dev/sda1   2048 419432447 419430400  200G Linux filesystem # ç¬¬ä¸€ä¸ªåˆ†åŒº

Command (m for help): n # ç»§ç»­åˆ›å»º
Partition number (2-128, default 2): # ç¬¬äºŒä¸ªåˆ†åŒºè¡¨ç¼–å·, é»˜è®¤è‡ªåŠ¨ç´¯åŠ 
First sector (419432448-1953525134, default 419432448):
Last sector, +/-sectors or +/-size{K,M,G,T,P} (419432448-1953525134, default 1953525134): +500G # åˆ†é… 500G

Created a new partition 2 of type 'Linux filesystem' and of size 500 GiB.

Command (m for help): p
Disk /dev/sda: 931.51 GiB, 1000204886016 bytes, 1953525168 sectors
Disk model: ST1000LM048-2E71
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes
Disklabel type: gpt
Disk identifier: E4FB3887-8182-4CC1-82F5-484D4B204F1B

Device         Start        End    Sectors  Size Type
/dev/sda1       2048  419432447  419430400  200G Linux filesystem
/dev/sda2  419432448 1468008447 1048576000  500G Linux filesystem # ç¬¬äºŒä¸ªåˆ†åŒºè¡¨

Command (m for help): n # ç»§ç»­åˆ›å»º
Partition number (3-128, default 3):
First sector (1468008448-1953525134, default 1468008448):
Last sector, +/-sectors or +/-size{K,M,G,T,P} (1468008448-1953525134, default 1953525134): # é»˜è®¤æœ€å¤§å€¼

Created a new partition 3 of type 'Linux filesystem' and of size 231.5 GiB.

Command (m for help): p
Disk /dev/sda: 931.51 GiB, 1000204886016 bytes, 1953525168 sectors
Disk model: ST1000LM048-2E71
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes
Disklabel type: gpt
Disk identifier: E4FB3887-8182-4CC1-82F5-484D4B204F1B

Device          Start        End    Sectors   Size Type
/dev/sda1        2048  419432447  419430400   200G Linux filesystem
/dev/sda2   419432448 1468008447 1048576000   500G Linux filesystem
/dev/sda3  1468008448 1953525134  485516687 231.5G Linux filesystem # ç¬¬ä¸‰ä¸ªåˆ†åŒºè¡¨
```

`fdisk` å·¥å…·å…¶å®ä¸ `gdisk` å·¥å…·æ“ä½œæ˜¯ä¸€è‡´çš„ï¼Œç…§ç€è¯´æ˜è¯´æ“ä½œå°±å¥½äº†~

## ä¿å­˜åˆ†åŒºè¡¨

æœ€ååˆ«å¿˜äº†ä¿å­˜å•Šï¼Œå¦‚æœæƒ³è¦ç›´æ¥ä¸¢å¼ƒå°±ä½¿ç”¨ `q` å‘½ä»¤å³å¯ï¼Œä½†æ˜¯å¦‚æœæƒ³è¦ä¿å­˜å˜æ›´å°±ä½¿ç”¨ `w`ï¼š

```bash
Command (m for help): w
The partition table has been altered.
Calling ioctl() to re-read partition table.
Syncing disks.
```

# å‚è€ƒé“¾æ¥ğŸ”—

https://en.wikipedia.org/wiki/GUID_Partition_Table

https://en.wikipedia.org/wiki/Master_boot_record

https://www.freecodecamp.org/news/mbr-vs-gpt-whats-the-difference-between-an-mbr-partition-and-a-gpt-partition-solved/

https://zhuanlan.zhihu.com/p/26098509

https://www.howtogeek.com/193669/whats-the-difference-between-gpt-and-mbr-when-partitioning-a-drive/